Imports System.Console
Module Module1
    Public Class player ' PLayer class-stores their colour, number and place
        Public colour As String
        Public number As Integer
        Public place As Integer
    End Class

    Sub Main() 'Main function
        createplayer()

        Dim board(100) As String


        Dim gameover = False
        Dim players = {1, 1, 1}

        Do 'Game loop-where all functions will be called repeatdely as game goes on

            displayingboard(board)


            Do

                For i = 1 To players.Length
                    Dim ns = Turn(i, players(i - 1))
                    If ns = 100 Then
                        Console.Clear()
                        Console.WriteLine("Player {0} wins!", i)
                        gameover = True
                        Return
                    End If
                    players(i - 1) = ns
                    Console.WriteLine()
                Next
            Loop



        Loop Until gameover = True ' loop until game is over/finishes
        Console.ReadKey()
    End Sub

    Dim SNL As New Dictionary(Of Integer, Integer) From {
       {4, 14},
       {9, 31},
       {17, 7},
       {20, 38},
       {28, 84},
       {40, 59},
       {51, 67},
       {54, 34},
       {62, 19},
       {63, 81},
       {64, 60},
       {71, 91},
       {87, 24},
       {93, 73},
       {95, 75},
       {99, 78}
   }
    Dim rand As New Random
    Const sixesThrowAgain = True
    Dim playerPlace As Integer

    Function Turn(ByVal player As Integer, square As Integer) As Integer
        Do
            Console.ReadKey()
            Dim roll = rand.Next(1, 6)
            Console.Write("Player {0}, on square {1}, rolls a {2}", player, square, roll)
            If square + roll > 100 Then
                Console.WriteLine(" but cannot move.")
            Else
                square += roll
                Console.WriteLine(" and moves to square {0}", square)

                If square = 100 Then
                    Return 100
                End If

                Dim nxt = square
                If SNL.ContainsKey(square) Then
                    nxt = SNL(nxt)
                End If
                If square < nxt Then
                    Console.WriteLine("Yay! Landed on a ladder. Climb up to {0}.", nxt)
                    If nxt = 100 Then
                        Return 100
                    End If
                    square = nxt
                ElseIf square > nxt Then
                    Console.WriteLine("Oops! Landed on a snake. Slither down to {0}.", nxt)
                    square = nxt
                End If
            End If

            If roll < 6 OrElse Not sixesThrowAgain Then
                Return square
            End If
            Console.WriteLine("Rolled a 6 so roll again.")

            Console.ReadKey()
        Loop
        Console.ReadKey()
    End Function





    'I removed the rolling dice function and instead added it within move s
    Sub createplayer() 'Creates new players via the class then assigns them their place on the baord(0)
        Dim player1, player2, player3, player4 As New player
        Dim players As New List(Of player)({player1, player2, player3, player4})
        For counter = 0 To 3

            players(counter).place = 0
            players(counter).number = counter + 1

            Dim choice As String
            Dim validcolour As Boolean = True
            Console.WriteLine("Colour - Enter any number between 1 - 10 : ")
            choice = Int(Console.ReadLine())
            players(counter).colour = choice
            Console.ForegroundColor = choice
            Console.WriteLine("Player 1 colour")
        Next
        Console.ReadKey()
        Console.Clear()

    End Sub

    Sub displayingboard(ByRef x() As String)
        For i = 1 To x.Length - 1
            If x(i) <> "" Then
                ForegroundColor = ConsoleColor.Green
            Else
                ForegroundColor = ConsoleColor.Gray
            End If
            Console.Write("[{0:00}] ", i)
            If i Mod 10 = 0 Then
                Console.WriteLine()
            End If
        Next
        Console.WriteLine()

    End Sub



End Module
